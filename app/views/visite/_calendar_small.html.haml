- @date = params[:calendar] ? Date.parse(params[:calendar]) : Date.today

- visite = current_user.visite.filter_calendar(@date).non_nel_baule.order("data desc").select("visite.data, count(visite.id) as tappe").group("visite.data").group_by{ |v| v.data}


#calendar_small.module
  %h2#month
    = link_to "<", {calendar: @date.prev_month}, class: "btn"
    = l @date, format: :month_year
    = link_to ">", {calendar: @date.next_month}, class: "btn"

  = calendar @date do |date|
    = date.day
    - if visite[date]
      %ul.unstyled
        %li
          = link_to giro_path(giorno: date) do
            %span{ class: "badge #{date.future? ? 'badge-important' : 'badge-info'}" }
              = visite[date].first.tappe